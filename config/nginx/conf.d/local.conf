# first we declare our upstream server, which is our Gunicorn application
upstream tour_management_project_server {
    # docker will automatically resolve this to the correct address
    # because we use the same name as the service: "tour_management"
    server tour_management:9300;
}


# now we declare our main server
server {

    listen 80;
    client_max_body_size 30M;
    uwsgi_buffer_size 64k;
    uwsgi_buffers 8 16k;
    server_name localhost;
    uwsgi_busy_buffers_size 70k;
    location / {
        # everything is passed to Gunicorn
	proxy_pass http://tour_management_project_server;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $host;
        proxy_redirect off;

proxy_connect_timeout 10080s;
proxy_send_timeout 10080;
proxy_read_timeout 10080;
proxy_buffer_size 64k;
proxy_buffers 16 32k;
proxy_busy_buffers_size 64k;
proxy_redirect off;
proxy_request_buffering off;
proxy_buffering off;
proxy_next_upstream timeout off;	
       
    }
 
}
